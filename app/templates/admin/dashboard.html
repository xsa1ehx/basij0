{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
  <h4 class="mb-4">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…</h4>

  <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø± -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card text-center shadow-sm border-primary">
        <div class="card-body">
          <h6 class="card-title text-muted">Ú©Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</h6>
          <h2 class="text-primary">{{ stats.total_logs }}</h2>
          <small class="text-muted">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card text-center shadow-sm border-success">
        <div class="card-body">
          <h6 class="card-title text-muted">Ø§Ù†ÙˆØ§Ø¹ Ø¹Ù…Ù„ÛŒØ§Øª</h6>
          <h2 class="text-success">{{ stats.actions|length }}</h2>
          <small class="text-muted">ØªØ¹Ø¯Ø§Ø¯ Ù†ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø®ØªÙ„Ù</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Ù„ÛŒØ³Øª Ø¹Ù…Ù„ÛŒØ§Øªâ€ŒÙ‡Ø§ -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-primary text-white">
      ğŸ“Š ØªÙˆØ²ÛŒØ¹ Ø¹Ù…Ù„ÛŒØ§Øªâ€ŒÙ‡Ø§
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover" id="operations-table">
          <thead>
            <tr>
              <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
              <th>ØªØ¹Ø¯Ø§Ø¯</th>
              <th>Ø¯Ø±ØµØ¯</th>
            </tr>
          </thead>
          <tbody>
            {% for action, count in stats.actions.items() %}
            <tr>
              <td>
                <span class="badge bg-info">{{ action }}</span>
              </td>
              <td><strong>{{ count }}</strong></td>
              <td>
                {% if stats.total_logs > 0 %}
                {% set percent = (count / stats.total_logs * 100)|round(1) %}
                <div class="progress" style="height: 10px;">
                  <div class="progress-bar bg-success" style="width: {{ percent }}%"></div>
                </div>
                <small class="text-muted">{{ percent }}%</small>
                {% else %}
                <small class="text-muted">0%</small>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Ø¢Ø®Ø±ÛŒÙ† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ -->
  <div class="card shadow-sm">
    <div class="card-header bg-warning text-dark">
      â° Ø¢Ø®Ø±ÛŒÙ† Ù„Ø§Ú¯â€ŒÙ‡Ø§
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-sm" id="recent-logs-table">
          <thead>
            <tr>
              <th>Ø²Ù…Ø§Ù†</th>
              <th>Ú©Ø§Ø±Ø¨Ø±</th>
              <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
              <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
              <th>IP</th>
            </tr>
          </thead>
          <tbody>
            {% for log in recent_logs %}
            <tr>
              <td>
                <small class="text-muted">{{ log.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</small>
              </td>
              <td>
                {% if log.user_id %}
                <span class="badge bg-info">Ú©Ø§Ø±Ø¨Ø± {{ log.user_id }}</span>
                {% else %}
                <span class="badge bg-secondary">Ø³ÛŒØ³ØªÙ…</span>
                {% endif %}
              </td>
              <td>
                <span class="badge bg-primary">{{ log.action }}</span>
              </td>
              <td>{{ log.description or '-' }}</td>
              <td><code>{{ log.ip_address or '-' }}</code></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="text-center mt-3">
        <a href="/admin/audit-logs" class="btn btn-primary">
          Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªÙ…Ø§Ù… Ù„Ø§Ú¯â€ŒÙ‡Ø§ â†’
        </a>
      </div>
    </div>
  </div>

</div>
{% endblock %}
